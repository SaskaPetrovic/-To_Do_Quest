<div data-controller="progress">
  <!----------------Title and return link---------------->
  <div class="container lessPadding">
    <div class="d-flex align-items-center justify-content-between">
      <%= link_to tasks_path, class: 'button-return' do %>
        <%= image_tag 'icons/return.svg', alt: 'Return'%>
      <% end %>
      <div class="flex-grow-1 text-center">
        <h2 class="mb-0"><%= @task.title %></h2>
      </div>
      <!-- An empty div to take the same space as the link to ensure the title is centered
      <div style="width: 24px;"></div>-->
       <%= link_to edit_task_path(@task), class: 'button-edit' do %>
      <%= image_tag 'icons/edit.svg', alt: 'Edit' %>
    <% end %>
    </div>
  </div>


  <div class="container">
    <h5 class="desc-title">Category</h5>
    <p class="desc-body"> <%= @task.sub_category.category.title %> </p>

    <h5 class="desc-title">Description</h5>
    <p class="desc-body"><%= @task.description %></p>

    <h5 class="desc-title">Estimated Duration</h5>
    <p class="desc-body"><%= @task.time %></p>

    <h5 class="desc-title">Priority</h5>
    <p class="desc-body"><%= @task.urgence %></p>

    <h5 class="desc-title">Rewards</h5>
    <p class="desc-reward">+ <%= @task.xp_reward %> XP</p>

    <% @task.category_rewards.each do |reward| %>
      <p class="desc-reward"><%= reward %></p>
    <% end %>
  </div>



    <h5 class="desc-title">checkpoints</h5>

  <%= simple_form_for @task, url: update_steps_task_path(@task), method: :patch, html: { local: true } do |form| %>
    <% if @task.steps.any? %>
      <div id="steps-list" class="pixel-corners">
        <div class="p-3 colored">
          <% @task.steps.each do |step| %>
            <div class="step-item d-flex align-items-center mb-2" data-step-id="<%= step.id %>">
              <%= form.check_box :completed, checked: step.completed, name: "task[steps_attributes][#{step.id}][completed]", class: 'me-2', data: { action: 'change->progress-bar#updateProgressBar' } %>
              <p class="desc-steps"><%= step.content %></p>
              <%= form.hidden_field :id, value: step.id, name: "task[steps_attributes][#{step.id}][id]" %>
            </div>
          <% end %>
        </div>
      </div>
    <% else %>
    <p>No steps available for this task.</p>
  <% end %>
<% end %>

    <div class="pt-1">
      <div class="pixel-corners margin-button">
        <h2 class="button-style colored d-flex justify-content-center">
          <%= link_to 'Edit', edit_task_path(@task), class: 'button-edit' %>
        </h2>
      </div>
    </div>


  </div>
</div>
